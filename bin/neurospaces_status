#!/usr/bin/perl -w
#!/usr/bin/perl -d:ptkdb -w
#


use strict;


my $packages
    = {
       neurospaces_prcs => {
			    directory => "$ENV{HOME}/neurospaces_project/model_container/source/c/snapshots/0",
			    disabled => 1,
			    priority => 1,
			    status => 'prcs diff neurospaces.prj `prcs 2>/dev/null execute --not ".*\(directory\|symlink\)" neurospaces.prj | grep -v "neurospaces\.prj" | grep -v "purkinjespine" ` -- --unified ',
			   },
       neurospaces => {
		       directory => "$ENV{HOME}/neurospaces_project/model_container/source/c/snapshots/0",
		       priority => 1,
		       status => "mtn status",
		      },
       heccer => {
		  directory => "$ENV{HOME}/neurospaces_project/heccer/source/c/snapshots/0",
		  priority => 2,
		  status => 'mtn status',
		 },
       ssp => {
	       directory => "$ENV{HOME}/neurospaces_project/ssp/source/perl/snapshots/0",
	       priority => 3,
	       status => 'mtn status',
	      },
       studio => {
		  directory => "$ENV{HOME}/neurospaces_project/studio/source/perl/snapshots/0",
		  priority => 4,
		  status => 'mtn status',
		 },
       simulation_browser => {
			      directory => "$ENV{HOME}/neurospaces_project/simulation_browser/source/perl/snapshots/0",
			      priority => 5,
			      status => 'mtn status',
			     },
       geometry => {
		    directory => "$ENV{HOME}/neurospaces_project/geometry/source/c/snapshots/0",
		    priority => 6,
		    status => 'mtn status',
		   },
       configuration => {
			 directory => "$ENV{HOME}/neurospaces_project/configuration",
			 priority => 7,
			 status => 'mtn status',
			},
       developer => {
		     directory => "$ENV{HOME}/neurospaces_project/project/developer/source/snapshots/0",
		     priority => 8,
		     status => 'mtn status',
		    },
       user => {
		directory => "$ENV{HOME}/neurospaces_project/project/user/source/snapshots/0",
		priority => 8.5,
		status => 'mtn status',
	       },
       system => {
		   directory => "$ENV{HOME}/neurospaces_project/.",
		   priority => 9,
		   status => 'mtn status',
		 },
      };


foreach my $package_name (
			     sort
			     {
				 $packages->{$a}->{priority} <=> $packages->{$b}->{priority}
			     }
			     keys
			     %$packages)
{
    my $package = $packages->{$package_name};

    if ($package->{disabled})
    {
# 	if ($option_verbose)
# 	{
# 	    print "$0: $package_name skipped, disabled is $package->{disabled}\n";
# 	}

	next;
    }

    my $directory = $package->{directory};

    print "*** package $package_name\n";

#     use Cwd;

#     my $current_directory = getcwd();

    use File::chdir;

    {
	local $CWD = $package->{directory};

	if ($!)
	{
	    die "$0: cannot change to directory ($directory)";
	}

	my $command = $package->{status};

	system $command;

    }
}


